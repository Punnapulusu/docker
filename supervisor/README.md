## Supervisor Buildfile for Docker

`Docker` containers naturally contains only one process.
Sometimes, that's good enough. Sometimes, you get a head-ache
with process mangling ([MAKE SURE YOU READ THIS][1]).

So we will run a container that run multiple processed inside.

The container will have `cron` and `exim4` daemon disabled by default.

## Environments

### Core feature

* `SUPERVISOR_LOG_LEVEL`: Logging level. Default: `info`.
* `FOOBAR_UID=<NUMBER>`: User to create / modify.
* `FOOBAR_GID=<NUMBER>`: Group to create / modify.

### Cron feature

`cron` is built with custom `debugging` enabled, that helps to
send a lot of information to standard output devices which will
be catched by `supervisor`. You can see `cron` log from `/supervisor/`.

* `CRON_ENABLE`: Enable cron daemon. Default: 0
* `CRON_LOGLEVEL`: Cron debugging level. Default: `bit`.
    Can be a white-space list of
      `ext`, `sch`, `proc`, `pars`, `load`, `misc`, `test`, `bit`.

### Exim4 feature

* `EXIM4_ENABLE`: Enable Exim4 daemon. Default: 0
* `EXIM4_UID`: The `uid` of `Debian-exim` account. Default: `10004`.
* `EXIM4_GID`: The `gid` of `Debian-exim` account. Default: `10004`.
* `EXIM4_MAILNAME`: The mail name (See `/etc/mailname`). Default: `$HOSTNAME.`
* `EXIM4_OTHER_NAMES`: Other local names (white space list). Default: empty.
* `EXIM4_MINE_CONFIG`: Use your own config mounted on `/etc/mailname`
      and `/etc/exim4/*`. Default: `0`.

## Volumes

* `/supervisor/`: All logs generated by main and sub processes.

## Generators

Before starting the main daemon, the script `/supervisor.sh` will
execute every `*.sh` found under `/etc/s.supervisor/` directory.
The purpose is to create a dynamic configuration for `supervisor`.

## Note

To avoid long typing, a symbolic link `/usr/bin/s` is created
for `/usr/bin/supervisorctl`. Now you can type, e.g, `s status`.

[1]: http://web.archive.org/web/20150424090620/https://blog.phusion.nl/2015/01/20/docker-and-the-pid-1-zombie-reaping-problem/
