###############################################################
# Dockerfile generated by Bocker-v1.0. Do not edit this file. #
###############################################################

FROM icy/supervisor:latest
MAINTAINER Anh K. Huynh <kyanh@theslinux.org>

ENV DEBIAN_FRONTEND noninteractive

# Bocker method => __ed_ship
# * The output is /bocker.sh in the result image.
# * List of methods:
#   - ed_apt_clean
#   - ed_apt_purge
#
# | set -eux
# | if [[ -f /bocker.sh ]]; then source /bocker.sh; fi
# | ed_apt_clean () 
# | { 
# |     rm -fv /var/cache/apt/*.bin;
# |     rm -fv /var/cache/apt/archives/*.*;
# |     rm -fv /var/lib/apt/lists/*.*;
# |     apt-get autoclean
# | }
# | ed_apt_purge () 
# | { 
# |     apt-get purge -y --auto-remove $@;
# |     ed_apt_clean
# | }
# | echo '#!/bin/bash' > /bocker.sh
# | echo '# This file is generated by Bocker.' >> /bocker.sh
# | declare -f >> /bocker.sh
# | echo 'if [[ -n "$@" ]]; then $@; fi; ' >> /bocker.sh
# | chmod 755 /bocker.sh
#
RUN echo c2V0IC1ldXgKaWYgW1sgLWYgL2JvY2tlci5zaCBdXTsgdGhlbiBzb3VyY2UgL2JvY2tlci5zaDsgZmkKZWRfYXB0X2NsZWFuICgpIAp7IAogICAgcm0gLWZ2IC92YXIvY2FjaGUvYXB0LyouYmluOwogICAgcm0gLWZ2IC92YXIvY2FjaGUvYXB0L2FyY2hpdmVzLyouKjsKICAgIHJtIC1mdiAvdmFyL2xpYi9hcHQvbGlzdHMvKi4qOwogICAgYXB0LWdldCBhdXRvY2xlYW4KfQplZF9hcHRfcHVyZ2UgKCkgCnsgCiAgICBhcHQtZ2V0IHB1cmdlIC15IC0tYXV0by1yZW1vdmUgJEA7CiAgICBlZF9hcHRfY2xlYW4KfQplY2hvICcjIS9iaW4vYmFzaCcgPiAvYm9ja2VyLnNoCmVjaG8gJyMgVGhpcyBmaWxlIGlzIGdlbmVyYXRlZCBieSBCb2NrZXIuJyA+PiAvYm9ja2VyLnNoCmRlY2xhcmUgLWYgPj4gL2JvY2tlci5zaAplY2hvICdpZiBbWyAtbiAiJEAiIF1dOyB0aGVuICRAOyBmaTsgJyA+PiAvYm9ja2VyLnNoCmNobW9kIDc1NSAvYm9ja2VyLnNoCg== | base64 -d | bash

# Bocker method => ed_phantomjs_install
#
# | set -eux
# | if [[ -f /bocker.sh ]]; then source /bocker.sh; fi
# | ed_phantomjs_install () 
# | { 
# |     apt-get update;
# |     apt-get install -y bzip2 fontconfig;
# |     cd /usr/;
# |     curl -Lso- https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-1.9.8-linux-x86_64.tar.bz2 | tar -xjf - phantomjs-1.9.8-linux-x86_64/bin/phantomjs --strip-components=1;
# |     ed_apt_purge bzip2;
# |     { 
# |         echo "#!/bin/bash";
# |         echo "/bocker.sh ed_phantomjs_generate_config"
# |     } > /etc/s.supervisor/phantomjs.sh
# | }
# | ed_phantomjs_install
#
RUN echo c2V0IC1ldXgKaWYgW1sgLWYgL2JvY2tlci5zaCBdXTsgdGhlbiBzb3VyY2UgL2JvY2tlci5zaDsgZmkKZWRfcGhhbnRvbWpzX2luc3RhbGwgKCkgCnsgCiAgICBhcHQtZ2V0IHVwZGF0ZTsKICAgIGFwdC1nZXQgaW5zdGFsbCAteSBiemlwMiBmb250Y29uZmlnOwogICAgY2QgL3Vzci87CiAgICBjdXJsIC1Mc28tIGh0dHBzOi8vYml0YnVja2V0Lm9yZy9hcml5YS9waGFudG9tanMvZG93bmxvYWRzL3BoYW50b21qcy0xLjkuOC1saW51eC14ODZfNjQudGFyLmJ6MiB8IHRhciAteGpmIC0gcGhhbnRvbWpzLTEuOS44LWxpbnV4LXg4Nl82NC9iaW4vcGhhbnRvbWpzIC0tc3RyaXAtY29tcG9uZW50cz0xOwogICAgZWRfYXB0X3B1cmdlIGJ6aXAyOwogICAgeyAKICAgICAgICBlY2hvICIjIS9iaW4vYmFzaCI7CiAgICAgICAgZWNobyAiL2JvY2tlci5zaCBlZF9waGFudG9tanNfZ2VuZXJhdGVfY29uZmlnIgogICAgfSA+IC9ldGMvcy5zdXBlcnZpc29yL3BoYW50b21qcy5zaAp9CmVkX3BoYW50b21qc19pbnN0YWxsCg== | base64 -d | bash

# Bocker method => ed_phantomjs_fix_permission
#
# | set -eux
# | if [[ -f /bocker.sh ]]; then source /bocker.sh; fi
# | ed_phantomjs_fix_permission () 
# | { 
# |     useradd -K UID_MIN=10001 phantomjs;
# |     chmod 755 /usr/bin/phantomjs;
# |     mkdir /home/phantomjs;
# |     chown phantomjs:phantomjs /home/phantomjs
# | }
# | ed_phantomjs_fix_permission
#
RUN echo c2V0IC1ldXgKaWYgW1sgLWYgL2JvY2tlci5zaCBdXTsgdGhlbiBzb3VyY2UgL2JvY2tlci5zaDsgZmkKZWRfcGhhbnRvbWpzX2ZpeF9wZXJtaXNzaW9uICgpIAp7IAogICAgdXNlcmFkZCAtSyBVSURfTUlOPTEwMDAxIHBoYW50b21qczsKICAgIGNobW9kIDc1NSAvdXNyL2Jpbi9waGFudG9tanM7CiAgICBta2RpciAvaG9tZS9waGFudG9tanM7CiAgICBjaG93biBwaGFudG9tanM6cGhhbnRvbWpzIC9ob21lL3BoYW50b21qcwp9CmVkX3BoYW50b21qc19maXhfcGVybWlzc2lvbgo= | base64 -d | bash

# Bocker method => __ed_ship
# * The output is /bocker.sh in the result image.
# * List of methods:
#   - ed_phantomjs_daemonize
#   - ed_phantomjs_fix_permission
#   - ed_phantomjs_generate_config
#
# | set -eux
# | if [[ -f /bocker.sh ]]; then source /bocker.sh; fi
# | ed_phantomjs_daemonize () 
# | { 
# |     fc-cache;
# |     exec /usr/bin/phantomjs --webdriver=8190 --debug=${PHANTOMJS_DEBUG:-false}
# | }
# | ed_phantomjs_fix_permission () 
# | { 
# |     useradd -K UID_MIN=10001 phantomjs;
# |     chmod 755 /usr/bin/phantomjs;
# |     mkdir /home/phantomjs;
# |     chown phantomjs:phantomjs /home/phantomjs
# | }
# | ed_phantomjs_generate_config () 
# | { 
# |     cat > /etc/s.supervisor/phantomjs.s  <<EOF
# | [program:phantomjs]
# | command=/bocker.sh ed_phantomjs_daemonize
# | process_name=%(program_name)s
# | numprocs=1
# | directory=/home/phantomjs/
# | umask=022
# | priority=999
# | autostart=true
# | autorestart=true
# | startsecs=1
# | startretries=3
# | exitcodes=0,2
# | stopsignal=TERM
# | stopwaitsecs=10
# | user=phantomjs
# | redirect_stderr=true
# | stdout_logfile=/supervisor/phantomjs.log
# | stdout_logfile_maxbytes=50MB
# | stdout_logfile_backups=10
# | stdout_capture_maxbytes=0
# | stdout_events_enabled=false
# | stderr_logfile=AUTO
# | stderr_logfile_maxbytes=50MB
# | stderr_logfile_backups=10
# | stderr_capture_maxbytes=0
# | stderr_events_enabled=false
# | environment=
# | EOF
# | 
# | }
# | echo '#!/bin/bash' > /bocker.sh
# | echo '# This file is generated by Bocker.' >> /bocker.sh
# | declare -f >> /bocker.sh
# | echo 'if [[ -n "$@" ]]; then $@; fi; ' >> /bocker.sh
# | chmod 755 /bocker.sh
#
RUN echo c2V0IC1ldXgKaWYgW1sgLWYgL2JvY2tlci5zaCBdXTsgdGhlbiBzb3VyY2UgL2JvY2tlci5zaDsgZmkKZWRfcGhhbnRvbWpzX2RhZW1vbml6ZSAoKSAKeyAKICAgIGZjLWNhY2hlOwogICAgZXhlYyAvdXNyL2Jpbi9waGFudG9tanMgLS13ZWJkcml2ZXI9ODE5MCAtLWRlYnVnPSR7UEhBTlRPTUpTX0RFQlVHOi1mYWxzZX0KfQplZF9waGFudG9tanNfZml4X3Blcm1pc3Npb24gKCkgCnsgCiAgICB1c2VyYWRkIC1LIFVJRF9NSU49MTAwMDEgcGhhbnRvbWpzOwogICAgY2htb2QgNzU1IC91c3IvYmluL3BoYW50b21qczsKICAgIG1rZGlyIC9ob21lL3BoYW50b21qczsKICAgIGNob3duIHBoYW50b21qczpwaGFudG9tanMgL2hvbWUvcGhhbnRvbWpzCn0KZWRfcGhhbnRvbWpzX2dlbmVyYXRlX2NvbmZpZyAoKSAKeyAKICAgIGNhdCA+IC9ldGMvcy5zdXBlcnZpc29yL3BoYW50b21qcy5zICA8PEVPRgpbcHJvZ3JhbTpwaGFudG9tanNdCmNvbW1hbmQ9L2JvY2tlci5zaCBlZF9waGFudG9tanNfZGFlbW9uaXplCnByb2Nlc3NfbmFtZT0lKHByb2dyYW1fbmFtZSlzCm51bXByb2NzPTEKZGlyZWN0b3J5PS9ob21lL3BoYW50b21qcy8KdW1hc2s9MDIyCnByaW9yaXR5PTk5OQphdXRvc3RhcnQ9dHJ1ZQphdXRvcmVzdGFydD10cnVlCnN0YXJ0c2Vjcz0xCnN0YXJ0cmV0cmllcz0zCmV4aXRjb2Rlcz0wLDIKc3RvcHNpZ25hbD1URVJNCnN0b3B3YWl0c2Vjcz0xMAp1c2VyPXBoYW50b21qcwpyZWRpcmVjdF9zdGRlcnI9dHJ1ZQpzdGRvdXRfbG9nZmlsZT0vc3VwZXJ2aXNvci9waGFudG9tanMubG9nCnN0ZG91dF9sb2dmaWxlX21heGJ5dGVzPTUwTUIKc3Rkb3V0X2xvZ2ZpbGVfYmFja3Vwcz0xMApzdGRvdXRfY2FwdHVyZV9tYXhieXRlcz0wCnN0ZG91dF9ldmVudHNfZW5hYmxlZD1mYWxzZQpzdGRlcnJfbG9nZmlsZT1BVVRPCnN0ZGVycl9sb2dmaWxlX21heGJ5dGVzPTUwTUIKc3RkZXJyX2xvZ2ZpbGVfYmFja3Vwcz0xMApzdGRlcnJfY2FwdHVyZV9tYXhieXRlcz0wCnN0ZGVycl9ldmVudHNfZW5hYmxlZD1mYWxzZQplbnZpcm9ubWVudD0KRU9GCgp9CmVjaG8gJyMhL2Jpbi9iYXNoJyA+IC9ib2NrZXIuc2gKZWNobyAnIyBUaGlzIGZpbGUgaXMgZ2VuZXJhdGVkIGJ5IEJvY2tlci4nID4+IC9ib2NrZXIuc2gKZGVjbGFyZSAtZiA+PiAvYm9ja2VyLnNoCmVjaG8gJ2lmIFtbIC1uICIkQCIgXV07IHRoZW4gJEA7IGZpOyAnID4+IC9ib2NrZXIuc2gKY2htb2QgNzU1IC9ib2NrZXIuc2gK | base64 -d | bash

VOLUME /usr/share/fonts

EXPOSE 8190

CMD ["/supervisor.sh"]
